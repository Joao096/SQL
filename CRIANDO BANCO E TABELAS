--CAPITULO 9 CRIANDO BANCO DE DADOS E TABELAS
--CRIANDO TABELA ROOM
CREATE TABLE ROOM (
ROOM_ID INTEGER PRIMARY KEY AUTOINCREMENT,
FLOOR_NUMBER INTEGER NOT NULL,
SEAT_APACITY NOT NULL
);
--CRIANDO TABELA PRESENTATION
CREATE TABLE PRESENTATION(
PRESENTATION_ID INTEGER PRIMARY KEY AUTOINCREMENT,
BOOKED_COMPANY_ID INTEGER NOT NULL,
BOOKED_ROOM_ID INTEGER NOT NULL,
START_TIME TIME,
END_TIME TIME
);
--CRIANDO TABELA ATTENDEE
CREATE TABLE ATTENDEE(
ATTENDEE_ID INTEGER PRIMARY KEY AUTOINCREMENT,
FIRST_NAME VARCHAR(30) NOT NULL,
LAST_NAME VARCHAR(30) NOT NULL,
PHONE INTEGER,
EMAIL VARCHAR(30),
VIP BOOLEAN DEFAULT(0)
);
--CRIANDO A TABELA PRESENTATION_ATTENDANCE
CREATE TABLE PRESENTATION_ATTENDANCE(
TICKET_ID INTEGER PRIMARY KEY AUTOINCREMENT,
PRESENTATION_ID INTEGER,
ATTENDEE_ID INTEGER
);

--CRIANDO UMA VIEW.
CREATE VIEW PRESENTATION_VW AS 
SELECT
COMPANY.NAME AS BOOKED_COMPANY,
ROOM.ROOM_ID AS ROOM_NUMBER,
ROOM.FLOOR_NUMBER AS FLOOR,
ROOM.SEAT_APACITY AS SEATS,
START_TIME,
END_TIME
FROM PRESENTATION
INNER JOIN COMPANY ON PRESENTATION.BOOKED_COMPANY_ID = COMPANY.COMPANY_ID
INNER JOIN ROOM ON PRESENTATION.BOOKED_ROOM_ID = ROOM.ROOM_ID;

--INSERINDO DADOS NA TABELA.
INSERT INTO ATTENDEE (FIRST_NAME, LAST_NAME)
VALUES('JOÃO','PEDRO');

--INSERINDO VARIOS DADOS DE UMA UNICA VEZ NA TABELA.
INSERT INTO ATTENDEE (FIRST_NAME,LAST_NAME,PHONE,EMAIL,VIP)
VALUES('Jon','Skeeter',4802185842,'john.skeeter@rex.net',1),
('Sam','Scala',2156783401,'sam.scala@gmail.com',0),
('Brittany','Fisher',5932857296,'brittany.fisher@outlook.com',0);
--COM A LINHA DE CODIGO ABAIXO IREMOS EXCLUIR OS DADOS QUE NAO TIVEREM E-MAIL E PHONE.
DELETE * FROM ATTENDEE
WHERE PHONE IS NULL
AND EMAIL IS NULL;
--ATUALIZANDO OS DADOS PARA MAIUSCULA.
UPDATE ATTENDEE SET EMAIL = upper(EMAIL);
UPDATE ATTENDEE SET FIRST_NAME = upper(FIRST_NAME), 
LAST_NAME = upper(LAST_NAME);
--ATUALIZANDO DADOS COM CONDIÇOES.
UPDATE ATTENDEE SET VIP = 1
WHERE ATTENDEE_ID IN (3,4);

SELECT * FROM ATTENDEE;