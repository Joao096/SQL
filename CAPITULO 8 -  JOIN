--CAPITLO 8 JOIN
--SELECIONANDO INFORMAÇOES DA TABELA CLIENTE E CLIENTE_PEDIDO
SELECT ORDER_ID,CUSTOMER.CUSTOMER_ID,
ORDER_DATE,
SHIP_DATE,
NAME,
STREET_ADDRESS,
CITY,
STATE,
ZIP,
PRODUCT_ID,
ORDER_QTY
FROM CUSTOMER INNER JOIN CUSTOMER_ORDER ON CUSTOMER.CUSTOMER_ID = CUSTOMER_ORDER.CUSTOMER_ID;

--SELECIONANDO INFORMAÇOES DA TABELA PRODUTO JUNTANDO COM AS INFORMAÇOES CLIENTE_PEDIDO
SELECT PRICE,DESCRIPTION,ORDER_QTY, SHIP_DATE
FROM PRODUCT INNER JOIN CUSTOMER_ORDER ON PRODUCT.PRODUCT_ID = CUSTOMER_ORDER.PRODUCT_ID;

--SELECIONANDO CLIENTES QUE NÃO POSSUI PEDIDOS.
SELECT CUSTOMER.CUSTOMER_ID, ORDER_ID,NAME AS CUSTOMER_NAME
FROM CUSTOMER LEFT JOIN CUSTOMER_ORDER ON CUSTOMER.CUSTOMER_ID = CUSTOMER_ORDER.CUSTOMER_ID
WHERE ORDER_ID IS NULL;
--SELECIONANDO INFORMAÇOES E 3 TABELAS, CLIENTE, CLIENTE_PEDIDO E PRODUTO.
SELECT
ORDER_ID,
CUSTOMER.CUSTOMER_ID,
NAME AS CUSTOMER_NAME,
STREET_ADDRESS,
CITY,
STATE,
ZIP,
ORDER_DATE,
PRODUCT_ID,
DESCRIPTION,
ORDER_QTY,
ORDER_QTY * PRICE AS REVENUE
FROM CUSTOMER INNER JOIN CUSTOMER_ORDER ON CUSTOMER.CUSTOMER_ID = CUSTOMER_ORDER.CUSTOMER_ID
INNER JOIN PRODUCT ON CUSTOMER_ORDER.PRODUCT_ID = PRODUCT.PRODUCT_ID;
